{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "ast.query request",
  "type": "object",
  "properties": {
    "path": { "type": "string" },
    "paths": {
      "type": "array",
      "items": { "type": "string" },
      "minItems": 1
    },
    "query": { "type": "string" },
    "mode": {
      "type": "string",
      "enum": ["query", "summary"]
    },
    "captures": {
      "type": "array",
      "items": { "type": "string" }
    },
    "include_context": { "type": "boolean" }
  },
  "additionalProperties": false,
  "if": {
    "properties": { "mode": { "const": "summary" } }
  },
  "then": {
    "$comment": "Summary mode accepts either 'path' or 'paths' and does not require 'query'."
  },
  "else": {
    "$comment": "Query mode requires both 'path' and 'query'.",
    "required": ["path", "query"]
  }
}
