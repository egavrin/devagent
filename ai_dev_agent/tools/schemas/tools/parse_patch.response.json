{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "properties": {
    "success": {
      "type": "boolean",
      "description": "Whether the patch was successfully parsed"
    },
    "error": {
      "type": "string",
      "description": "Error message if success is false"
    },
    "patch_info": {
      "type": "object",
      "properties": {
        "commit": {"type": "string"},
        "author": {"type": "string"},
        "date": {"type": "string"},
        "message": {"type": "string"}
      }
    },
    "files": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "path": {"type": "string"},
          "change_type": {"type": "string", "enum": ["added", "modified", "deleted", "renamed"]},
          "old_path": {"type": ["string", "null"]},
          "language": {"type": "string"},
          "hunks": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "header": {"type": "string"},
                "old_start": {"type": "integer"},
                "old_count": {"type": "integer"},
                "new_start": {"type": "integer"},
                "new_count": {"type": "integer"},
                "added_lines": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "line_number": {"type": "integer"},
                      "content": {"type": "string"},
                      "indentation": {"type": "string"}
                    },
                    "required": ["line_number", "content", "indentation"]
                  }
                },
                "removed_lines": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "line_number": {"type": "integer"},
                      "content": {"type": "string"}
                    },
                    "required": ["line_number", "content"]
                  }
                },
                "context_lines": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "line_number": {"type": "integer"},
                      "content": {"type": "string"}
                    },
                    "required": ["line_number", "content"]
                  }
                }
              },
              "required": ["header", "old_start", "old_count", "new_start", "new_count", "added_lines", "removed_lines"]
            }
          },
          "stats": {
            "type": "object",
            "properties": {
              "additions": {"type": "integer"},
              "deletions": {"type": "integer"},
              "total_hunks": {"type": "integer"}
            },
            "required": ["additions", "deletions", "total_hunks"]
          }
        },
        "required": ["path", "change_type", "language", "hunks", "stats"]
      }
    },
    "summary": {
      "type": "object",
      "properties": {
        "total_files": {"type": "integer"},
        "files_added": {"type": "integer"},
        "files_modified": {"type": "integer"},
        "files_deleted": {"type": "integer"},
        "total_additions": {"type": "integer"},
        "total_deletions": {"type": "integer"}
      },
      "required": ["total_files", "files_added", "files_modified", "files_deleted", "total_additions", "total_deletions"]
    }
  },
  "required": ["success", "files", "summary"]
}
